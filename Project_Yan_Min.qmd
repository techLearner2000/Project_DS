---
title: Predicting the Winner in CS:GO Matches
subtitle: "(STATS/CSE 780 course project)"
author: "Yan Min (Student number: 400546093)"
date: today
format: pdf
editor: visual
header-includes:
   - \usepackage{amsmath}
   - \usepackage{float}
bibliography: ./project.bib
fontsize: 11pt
geometry: 
  - margin = 1in
linestretch: 1.5
execute: 
  echo: true
  message: false
  warning: false
---

\newpage

## Abstract

This study explores the application of advanced machine learning techniques, specifically Random Forest and Deep Neural Network(DNN), in predicting the winners of CS:GO matches. We aim to use the past data of matches to forecast future match results. Leveraging the dataset provided by Skybox as part of their CS:GO AI Challenge, we preprocessed the data and then fed the data into the models. The performance of these two models are evaluated by accuracy, precision, and recall metrics. Our results yielded relatively high accuracies for both models, up to about 75%. The two machine learning models we developed improve the prediction and analysis of future match results, which is beneficial for the development of eSports.

## Introduction

The dataset[@Skybox] was originally published by Skybox as part of their CS:GO AI Challenge, running from Spring to Fall 2020. The dataset consists of around 700 demos from high level tournament play in 2019 and 2020. Warmup rounds and restarts have been filtered, and for the remaining live rounds a round snapshot have been recorded every 20 seconds until the round is decided. We want to use this dataset to predict the final winner, which can be seen as a classification problem.  

There are totally 122410 entries and 97 colums in this dataset. The features have one boolean type, 94 float types and 2 object types. The number of entries is greater than the number of parameters. There are no null values in this dataset. We choose `round_winner` as the output value, which is consisted of the winners `CT` and `T`. There are other different types of features, such as `time_left`, `ct_score` and `ct_health`, which will be used as the input features. Figure \ref{figure1} shows the distrubutions of selected features after feature slection.

```{=tex}
\begin{figure}[H]
  \centering
  \includegraphics[width = 0.45\textwidth]{all_data.png}
  \caption{The distribution of selected variables after feature selection}
  \label{figure1}
\end{figure}
```

## Methods

Firstly, we will do Exploratory Data Analysis(EDA) to find out the relationships among different features. Then, we will drop unnessaray columns and transform the values of some features based on the analysis. Afterwards, we will do scaling. 

The reasons for choosing random forest are that it can capture the complex interactions and non-linear relationships among the features, and that it is suitable for classification problems(`CT` or `T`). For the model of random forest, beforing fitting the data, we do the principal component analysis(PCA) for the features. Regarding to the tuning of the parameters, we do grid searching to find the best parameters for the model and the best accuracy score. Then we use the training dataset to check whether the model is overfitting and the test dataset to get the accuracy score. 

The reasons for choosing deep neural network(DNN) are that it suits for large datasets, which in this case consists of `122410` entries, and that we can benefit from the trained model for future use. For the model of DNN, we set the number of layers as `4`, the number of nodes of each layer as `300`, and the number of epochs as `50`. Between each layer, we also add batch normalization layers, in order to normalize the activations. We choose the binary cross entropy as the loss function and the `Nadam` as the optimizer. Then we build the DNN model and render the accuracy scores for the training set and test set.

## Results

Fistly, we do feature selection. As there are 97 variables in this dataset, we need to decrease the number of features in order to reduce the training time. As we can see, over eighty features are about how much of each weapon is left in the game and we can know that these features are high correlated about `ct_money` and `t_money`. So we drop them off and select 15 of them. Then we draw the correlation matrix of the selected features. From figure \ref{figure2}, we can tell that `ct_players_alive` is high correlated with `ct_health`, and `t_players_alive` is highly correlated with `t_money`. So we drop off the colomns of `ct_players_alive` and `t_players_alive`. Then we can use the left 13 features as inputs and `round_winner` as outputs. To do the prediction, in the colomn of `round_winner`, we convert `CT` to `0`, and `T` to `1`.

For the column of `bomb_planted`, at first, the values are boolean types and we convert `true` to `1` and `false` to `0`. For others features, we do data scaling. For the column of `round_winner`, the number of `CT` and the number of `T` are close to `50%` of the total entries. So we can directly split the dataset. After this, we divide the dataset into training set and test set, according to the test size of `0.3`.

```{=tex}
\begin{figure}[H]
  \centering
  \includegraphics[width = 0.45\textwidth]{corr.png}
  \caption{The correlation matrix of selected features}
  \label{figure2}
\end{figure}
```

```{=tex}
\begin{figure}[H]
  \centering
  \includegraphics[width = 0.45\textwidth]{feature.png}
  \caption{The Feature Importance Derived from the Random Forest Model}
  \label{figure3}
\end{figure}
```

Deriving from grid searching, we have that the best parameter for `min_samples_split` is `8`. We can obtain feature importance from the Random Forest mode, as figure ref{figure3} shows. We can see that `t_score` is the most important among all features, following by `ct_score`. We can also see that the scores of both team make the biggest impact on final results, as the scores may impact each team's morale. As table \ref{t} shows, the accuracy score for the training set is `0.791`, which is accepetable since it's not overfitting, and the accuracy score for the test set is `0.764`, which is pretty good for prediction. Plus, the F1 score of the random forest model is `0.765`, which indicates a good balance between precision and recall in the model's predictions. In a real game, this accuracy is significant in predicting the outcome of the game. 

```{=tex}
\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|}
  \hline
  & \textbf{Random Forest} & \textbf{DNN} \\ \hline
  \textbf{Accuracy for Test Set} & 0.764 & 0.752 \\ \hline
  \textbf{Accuracy for Training Set} & 0.791 & 0.453 \\ \hline
  \end{tabular}
  \caption{Accuracies for both models}
  \label{t}
\end{table}
```

For the DNN model, the accuracy on the test set is 0.752, while on the training set, it is 0.453. There is no strong sign of overfitting.  

## Conclusion

\clearpage

## Supplementary material

\newpage

## References
